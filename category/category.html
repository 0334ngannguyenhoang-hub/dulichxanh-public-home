<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <title>Chuy√™n m·ª•c</title>

  <!-- CSS chung -->
  <link rel="stylesheet" href="../home/style.css" />

  <!-- CSS ri√™ng c·ªßa category -->
  <link rel="stylesheet" href="category.css" />

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Merriweather:wght@400;700&display=swap" rel="stylesheet" />
</head>

<body>

  <div id="topbar-container"></div>
  <div id="header-container"></div>
  <div id="menu-container"></div>

  <!-- Load c·∫•u tr√∫c header t·ª´ index t·ª± ƒë·ªông -->
<script>
async function loadCommonLayout() {
  const res = await fetch("../index.html");
  const text = await res.text();

  const parser = new DOMParser();
  const doc = parser.parseFromString(text, "text/html");

  document.getElementById("topbar-container").innerHTML =
    doc.querySelector(".topbar").outerHTML;

  document.getElementById("header-container").innerHTML =
    doc.querySelector(".header").outerHTML;

  document.getElementById("menu-container").innerHTML =
    doc.querySelector(".menu").outerHTML;
  
    // ‚è∞ START CLOCK SAU KHI TOPBAR ƒê∆Ø·ª¢C G·∫ÆN
if (typeof startTopbarClock === "function") {
  startTopbarClock();
}


  /* Fix Logo + Home link */
  const logo = document.querySelector(".logo a");
  if (logo) logo.href = "/index.html";

  const homeBtn = document.querySelector(".menu-center li:first-child a");
  if (homeBtn) homeBtn.href = "/index.html";

  /* ‚≠ê RENDER SUB BUTTONS + LOAD CATEGORY */
  renderSubButtons();
  loadCategory();

  /* ‚≠ê Rebind weather popup */
  initWeatherPopup();

  /* ‚≠ê Restart Banner */
  initBannerCarousel();
}
loadCommonLayout();
</script>


<script>
function initWeatherPopup() {
  const icon = document.querySelector(".weather-icon");

  if (!icon) {
    console.warn("‚ö† weather-icon ch∆∞a load xong");
    return;
  }

  icon.addEventListener("click", () => {
    document.getElementById("weather-popup").classList.remove("hidden");

    fetch("https://api.open-meteo.com/v1/forecast?latitude=21.03&longitude=105.83&current_weather=true")
      .then(res => res.json())
      .then(data => {
        const w = data.current_weather;
        document.getElementById("weather-status").innerHTML = `
          ‚õÖ Nhi·ªát ƒë·ªô: <b>${w.temperature}¬∞C</b><br>
          üí® Gi√≥: ${w.windspeed} km/h<br>
          üïí ${w.time.replace("T", " ")}
        `;
      });
  });
}

function closeWeatherPopup() {
  document.getElementById("weather-popup").classList.add("hidden");
}
</script>


<script>
  document.addEventListener("click", (e) => {
    const title = document.getElementById("cat-title");
    if (e.target === title) {
      window.location.href = `category.html?cat=${cat}`;
    }
  });
</script>

<script src="../home/topbar-time.js"></script>


  <!-- ===================== CHUY√äN M·ª§C ===================== -->
  <section class="category-header container anim-in">
    <h1 id="cat-title" class="cat-title-btn"></h1>

    <div id="cat-sub" class="subcategory-list"></div>
  </section>

  <!-- ===================== LIST B√ÄI VI·∫æT ===================== -->
  <section class="category-content container anim-in">
  <div class="category-grid">

    <!-- C·ªòT TR√ÅI -->
    <div id="cat-main" class="cat-main"></div>

    <!-- C·ªòT PH·∫¢I -->
    <div class="cat-right">

      <img src="../img/adv1.jpg" class="cat-adv">

      <h3 class="side-title">üî• B√†i ƒë·ªçc nhi·ªÅu</h3>
      <div id="cat-trending" class="cat-trending"></div>

    </div>

  </div>
</section>

<button id="backToTop" class="back-to-top">‚Üë</button>

  <!-- FOOTER -->
  <footer class="footer">
    <p style="padding-left: 50px">
      ¬© T·∫°p ch√≠ Du l·ªãch Xanh
    </p>
  </footer>


<!-- POPUP TH·ªúI TI·∫æT -->
<div id="weather-popup" class="weather-popup hidden">
  <div class="weather-box">
    <h3>Th·ªùi ti·∫øt h√¥m nay</h3>
    <p id="weather-status">ƒêang t·∫£i...</p>
    <button onclick="closeWeatherPopup()">ƒê√≥ng</button>
  </div>
</div>

<script src="../home/home.js"></script>
<script src="category.js"></script>
</body>

</html>
